

\href{http://travis-ci.org/bestiejs/json3}{\tt }

{\bfseries J\+S\+ON 3} is a modern J\+S\+ON implementation compatible with a variety of Java\+Script platforms, including Internet Explorer 6, Opera 7, Safari 2, and Netscape 6. The current version is {\bfseries 3.\+3.\+2}.


\begin{DoxyItemize}
\item \href{http://cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.js}{\tt Development Version} $\ast$(43 KB; uncompressed with comments)$\ast$
\item \href{http://cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.min.js}{\tt Production Version} $\ast$(3.\+5 KB; compressed and {\ttfamily gzip}-\/ped)$\ast$
\end{DoxyItemize}

Special thanks to \href{http://cdnjs.com/libraries/json3/}{\tt cdnjs} and \href{http://www.jsdelivr.com/#!json3}{\tt js\+Delivr} for hosting C\+DN copies of J\+S\+ON 3.

\href{http://json.org/}{\tt J\+S\+ON} is a language-\/independent data interchange format based on a loose subset of the Java\+Script grammar. Originally popularized by \href{http://www.crockford.com/}{\tt Douglas Crockford}, the format was standardized in the \href{http://es5.github.com/}{\tt fifth edition} of the E\+C\+M\+A\+Script specification. The 5.\+1 edition, ratified in June 2011, incorporates several modifications to the grammar pertaining to the serialization of dates.

J\+S\+ON 3 exposes two functions\+: {\ttfamily stringify()} for \href{https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/stringify}{\tt serializing} a Java\+Script value to J\+S\+ON, and {\ttfamily parse()} for \href{https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/parse}{\tt producing} a Java\+Script value from a J\+S\+ON source string. It is a {\bfseries drop-\/in replacement} for \href{http://json.org/js}{\tt J\+S\+ON 2}. The functions behave exactly as described in the E\+C\+M\+A\+Script spec, {\bfseries except} for the date serialization discrepancy noted below.

The J\+S\+ON 3 parser does {\bfseries not} use {\ttfamily eval} or regular expressions. This provides security and performance benefits in obsolete and mobile environments, where the margin is particularly significant. The complete \href{http://jsperf.com/json3}{\tt benchmark suite} is available on \href{http://jsperf.com/}{\tt js\+Perf}.

The project is \href{http://git.io/json3}{\tt hosted on Git\+Hub}, along with the \href{http://bestiejs.github.io/json3/test/test_browser.html}{\tt unit tests}. It is part of the \href{https://github.com/bestiejs}{\tt Bestie\+JS} family, a collection of best-\/in-\/class Java\+Script libraries that promote cross-\/platform support, specification precedents, unit testing, and plenty of documentation.

\section*{Changes from J\+S\+ON 2}

J\+S\+ON 3...


\begin{DoxyItemize}
\item Correctly serializes primitive wrapper objects.
\item Throws a {\ttfamily Type\+Error} when serializing cyclic structures (J\+S\+ON 2 recurses until the call stack overflows).
\item Utilizes {\bfseries feature tests} to detect broken or incomplete {\itshape native} J\+S\+ON implementations (J\+S\+ON 2 only checks for the presence of the native functions). The tests are only executed once at runtime, so there is no additional performance cost when parsing or serializing values.
\end{DoxyItemize}

{\bfseries As of v3.\+2.\+3}, J\+S\+ON 3 is compatible with \href{http://prototypejs.org}{\tt Prototype} 1.\+6.\+1 and older.

In contrast to J\+S\+ON 2, J\+S\+ON 3 {\bfseries does not}...


\begin{DoxyItemize}
\item Add {\ttfamily to\+J\+S\+O\+N()} methods to the {\ttfamily Boolean}, {\ttfamily Number}, and {\ttfamily String} prototypes. These are not part of any standard, and are made redundant by the design of the {\ttfamily stringify()} implementation.
\item Add {\ttfamily to\+J\+S\+O\+N()} or {\ttfamily to\+I\+S\+O\+String()} methods to {\ttfamily Date.\+prototype}. See the note about date serialization below.
\end{DoxyItemize}

\subsection*{Date Serialization}

{\bfseries J\+S\+ON 3 deviates from the specification in one important way}\+: it does not define {\ttfamily Date\+::to\+I\+S\+O\+String()} or {\ttfamily Date\+::to\+J\+S\+O\+N()}. This preserves Common\+JS compatibility and avoids polluting native prototypes. Instead, date serialization is performed internally by the {\ttfamily stringify()} implementation\+: if a date object does not define a custom {\ttfamily to\+J\+S\+O\+N()} method, it is serialized as a \href{http://es5.github.com/#x15.9.1.15}{\tt simplified I\+SO 8601 date-\/time string}.

{\bfseries Several native {\ttfamily Date\+::to\+J\+S\+O\+N()} implementations produce date time strings that do {\itshape not} conform to the grammar outlined in the spec}. For instance, all versions of Safari 4, as well as J\+S\+ON 2, fail to serialize extended years correctly. Furthermore, J\+S\+ON 2 and older implementations omit the milliseconds from the date-\/time string (optional in ES 5, but required in 5.\+1). Finally, in all versions of Safari 4 and 5, serializing an invalid date will produce the string {\ttfamily \char`\"{}\+Invalid Date\char`\"{}}, rather than {\ttfamily null}. Because these environments exhibit other serialization bugs, however, J\+S\+ON 3 will override the native {\ttfamily stringify()} implementation.

Portions of the date serialization code are adapted from the \href{https://github.com/Yaffle/date-shim}{\tt {\ttfamily date-\/shim}} project.

\section*{Usage}

\subsection*{Web Browsers}

\begin{DoxyVerb}<script src="//cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.min.js"></script>
<script>
  JSON.stringify({"Hello": 123});
  // => '{"Hello":123}'
  JSON.parse("[[1, 2, 3], 1, 2, 3, 4]", function (key, value) {
    if (typeof value == "number") {
      value = value % 2 ? "Odd" : "Even";
    }
    return value;
  });
  // => [["Odd", "Even", "Odd"], "Odd", "Even", "Odd", "Even"]
</script>
\end{DoxyVerb}


{\bfseries When used in a web browser}, J\+S\+ON 3 exposes an additional {\ttfamily J\+S\+O\+N3} object containing the {\ttfamily no\+Conflict()} and {\ttfamily run\+In\+Context()} functions, as well as aliases to the {\ttfamily stringify()} and {\ttfamily parse()} functions.

\subsubsection*{{\ttfamily no\+Conflict} and {\ttfamily run\+In\+Context}}


\begin{DoxyItemize}
\item {\ttfamily J\+S\+O\+N3.\+no\+Conflict()} restores the original value of the global {\ttfamily J\+S\+ON} object and returns a reference to the {\ttfamily J\+S\+O\+N3} object.
\item {\ttfamily J\+S\+O\+N3.\+run\+In\+Context(\mbox{[}context, exports\mbox{]})} initializes J\+S\+ON 3 using the given {\ttfamily context} object (e.\+g., {\ttfamily window}, {\ttfamily global}, etc.), or the global object if omitted. If an {\ttfamily exports} object is specified, the {\ttfamily stringify()}, {\ttfamily parse()}, and {\ttfamily run\+In\+Context()} functions will be attached to it instead of a new object.
\end{DoxyItemize}

\subsubsection*{Asynchronous Module Loaders}

J\+S\+ON 3 is defined as an \href{https://github.com/amdjs/amdjs-api/wiki/AMD#define-function-}{\tt anonymous module} for compatibility with \href{http://requirejs.org/}{\tt Require\+JS}, \href{https://github.com/cujojs/curl}{\tt {\ttfamily curl.\+js}}, and other asynchronous module loaders. \begin{DoxyVerb}<script src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.js"></script>
<script>
  require({
    "paths": {
      "json3": "./path/to/json3"
    }
  }, ["json3"], function (JSON) {
    JSON.parse("[1, 2, 3]");
    // => [1, 2, 3]
  });
</script>
\end{DoxyVerb}


To avoid issues with third-\/party scripts, {\bfseries J\+S\+ON 3 is exported to the global scope even when used with a module loader}. If this behavior is undesired, {\ttfamily J\+S\+O\+N3.\+no\+Conflict()} can be used to restore the global {\ttfamily J\+S\+ON} object to its original value.

\subsection*{Common\+JS Environments}

\begin{DoxyVerb}var JSON3 = require("./path/to/json3");
JSON3.parse("[1, 2, 3]");
// => [1, 2, 3]
\end{DoxyVerb}


\subsection*{Java\+Script Engines}

\begin{DoxyVerb}load("path/to/json3.js");
JSON.stringify({"Hello": 123, "Good-bye": 456}, ["Hello"], "\t");
// => '{\n\t"Hello": 123\n}'
\end{DoxyVerb}


\section*{Compatibility}

J\+S\+ON 3 has been {\bfseries tested} with the following web browsers, Common\+JS environments, and Java\+Script engines.

\subsection*{Web Browsers}


\begin{DoxyItemize}
\item Windows \href{http://www.microsoft.com/windows/internet-explorer}{\tt Internet Explorer}, version 6.\+0 and higher
\item Mozilla \href{http://www.mozilla.com/firefox}{\tt Firefox}, version 1.\+0 and higher
\item Apple \href{http://www.apple.com/safari}{\tt Safari}, version 2.\+0 and higher
\item \href{http://www.opera.com}{\tt Opera} 7.\+02 and higher
\item \href{http://sillydog.org/narchive/gecko.php}{\tt Mozilla} 1.\+0, \href{http://sillydog.org/narchive/}{\tt Netscape} 6.\+2.\+3, and \href{http://www.seamonkey-project.org/}{\tt Sea\+Monkey} 1.\+0 and higher
\end{DoxyItemize}

\subsection*{Common\+JS Environments}


\begin{DoxyItemize}
\item \href{http://nodejs.org/}{\tt Node} 0.\+2.\+6 and higher
\item \href{http://ringojs.org/}{\tt Ringo\+JS} 0.\+4 and higher
\item \href{http://narwhaljs.org/}{\tt Narwhal} 0.\+3.\+2 and higher
\end{DoxyItemize}

\subsection*{Java\+Script Engines}


\begin{DoxyItemize}
\item Mozilla \href{http://www.mozilla.org/rhino}{\tt Rhino} 1.\+5\+R5 and higher
\item Web\+Kit \href{https://trac.webkit.org/wiki/JSC}{\tt J\+SC}
\item Google \href{http://code.google.com/p/v8}{\tt V8}
\end{DoxyItemize}

\subsection*{Known Incompatibilities}


\begin{DoxyItemize}
\item Attempting to serialize the {\ttfamily arguments} object may produce inconsistent results across environments due to specification version differences. As a workaround, please convert the {\ttfamily arguments} object to an array first\+: {\ttfamily J\+S\+O\+N.\+stringify(\mbox{[}\mbox{]}.slice.\+call(arguments, 0))}.
\end{DoxyItemize}

\subsection*{Required Native Methods}

J\+S\+ON 3 assumes that the following methods exist and function as described in the E\+C\+M\+A\+Script specification\+:


\begin{DoxyItemize}
\item The {\ttfamily Number}, {\ttfamily String}, {\ttfamily Array}, {\ttfamily Object}, {\ttfamily Date}, {\ttfamily Syntax\+Error}, and {\ttfamily Type\+Error} constructors.
\item {\ttfamily String.\+from\+Char\+Code}
\item {\ttfamily Object\+::to\+String}
\item {\ttfamily Function\+::call}
\item {\ttfamily Math.\+floor}
\item {\ttfamily Number\+::to\+String}
\item {\ttfamily Date\+::value\+Of}
\item {\ttfamily String.\+prototype}\+: {\ttfamily index\+Of}, {\ttfamily char\+Code\+At}, {\ttfamily char\+At}, {\ttfamily slice}.
\item {\ttfamily Array.\+prototype}\+: {\ttfamily push}, {\ttfamily pop}, {\ttfamily join}.
\end{DoxyItemize}

\section*{Contribute}

Check out a working copy of the J\+S\+ON 3 source code with \href{http://git-scm.com/}{\tt Git}\+: \begin{DoxyVerb}$ git clone git://github.com/bestiejs/json3.git
$ cd json3
\end{DoxyVerb}


If you\textquotesingle{}d like to contribute a feature or bug fix, you can \href{http://help.github.com/fork-a-repo/}{\tt fork} J\+S\+ON 3, commit your changes, and \href{http://help.github.com/send-pull-requests/}{\tt send a pull request}. Please make sure to update the unit tests in the {\ttfamily test} directory as well.

Alternatively, you can use the \href{https://github.com/bestiejs/json3/issues}{\tt Git\+Hub issue tracker} to submit bug reports, feature requests, and questions, or send tweets to \href{http://twitter.com/kitcambridge}{\tt }.

J\+S\+ON 3 is released under the \href{http://kit.mit-license.org/}{\tt M\+IT License}. 