<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: gruntfile-gtx</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">gruntfile-gtx </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="http://travis-ci.org/Bartvds/gruntfile-gtx"></a> <a href="https://gemnasium.com/Bartvds/gruntfile-gtx"></a> <a href="http://badge.fury.io/js/gruntfile-gtx"></a></p>
<blockquote class="doxtable">
<p>Turbo, spoilers and a sunroof for your Gruntfile. </p>
</blockquote>
<p><a href="http://www.gruntjs.com">Grunt</a> enhancement to make gruntfile task management more dynamic and powerful. Handle demanding setups while keeping your Gruntfile shiny and DRY.</p>
<h2>Features</h2>
<ul>
<li>Use macros to generate chains of related (semi-anonymous) plugin task instances.</li>
<li>Use tags to group and select similar targets.</li>
<li>Create new aliases by filtering tasks on various fields.</li>
<li>Transparently streamline gruntfile api a little.</li>
</ul>
<p>Macros are powerful to define chains of targets for different plugins that together define a blueprint for build-sub-process. Create different instances that share or change parameters like identifiers, (partial) paths.</p>
<h3>API Change</h3>
<p>Per <code>v0.1.0</code> the API was updated. The old docs can be found <a href="https://github.com/Bartvds/gruntfile-gtx/commit/3472afa6546980e2a00933023c357dd516fcba2c">here</a></p>
<h2>Usage</h2>
<p>Check the <a href="https://github.com/Bartvds/gruntfile-gtx/blob/master/Gruntfile.js">Gruntfile</a> for practical <a href="https://en.wikipedia.org/wiki/Dogfooding">dogfooding</a> and <a href="https://github.com/Bartvds/gruntfile-gtx/tree/master/test/spec">browse the tests</a> for some more options.</p>
<h3>Example</h3>
<div class="fragment"><div class="line">module.exports = function (grunt) {</div><div class="line"></div><div class="line">    // get the gtx instance</div><div class="line">    var gtx = require(&#39;gruntfile-gtx&#39;).wrap(grunt);</div></div><!-- fragment --><p>Load some plugins: </p><div class="fragment"><div class="line">gtx.loadNpm(</div><div class="line">    &#39;myPlugin&#39;,</div><div class="line">    &#39;myOtherPlugin&#39;</div><div class="line">);</div><div class="line">//classic array</div><div class="line">gtx.loadNpm([</div><div class="line">    &#39;myPlugin&#39;,</div><div class="line">    &#39;myOtherPlugin&#39;</div><div class="line">]);</div><div class="line">// folder</div><div class="line">gtx.loadTasks(&#39;./tasks&#39;);</div><div class="line"></div><div class="line">// alternately load automatically (from ./tasks and ./node_modules)</div><div class="line">gtx.loadAuto();</div></div><!-- fragment --><p>Build the grunt config like the regular structure: </p><div class="fragment"><div class="line">gtx.config({</div><div class="line">    // read and blend objects</div><div class="line">    pkg: gtx.readJSON(&#39;package.json&#39;, {title: &#39;foo&#39;}, &#39;./conf/overwrite.json&#39;),</div><div class="line">    myPlugin: {</div><div class="line">        options: {</div><div class="line">            //..</div><div class="line">        },</div><div class="line">        main: {</div><div class="line">            src: [&#39;./files/main/*.js&#39;]</div><div class="line">        }</div><div class="line">    },</div><div class="line">    myOtherPlugin: {</div><div class="line">        main: {</div><div class="line">            src: [&#39;./files/dev/*.js&#39;]</div><div class="line">        }</div><div class="line">    }</div><div class="line">});</div><div class="line">// ... but split over multiple statements</div><div class="line">gtx.config({</div><div class="line">    myPlugin: {</div><div class="line">        dev: {</div><div class="line">            src: [&#39;./files/dev/*.js&#39;]</div><div class="line">        }</div><div class="line">    }</div><div class="line">});</div><div class="line">// or directly set config objects</div><div class="line">gtx.configFor(&#39;myPlugin&#39;, &#39;beta&#39;, {</div><div class="line">    src: [&#39;./files/beta/*.js&#39;]</div><div class="line">});</div></div><!-- fragment --><p>Define tasks: </p><div class="fragment"><div class="line">// define a simple task</div><div class="line">gtx.call(&#39;say&#39;, function() {</div><div class="line">    grunt.log.writeln(&#39;hello!&#39;);</div><div class="line">});</div><div class="line"></div><div class="line">// define a multi-task</div><div class="line">gtx.multi(&#39;alpha_multi&#39;, function() {</div><div class="line">    var options = this.options({</div><div class="line">        //..</div><div class="line">    });</div><div class="line">    grunt.log.writeln(&#39;hello!&#39;);</div><div class="line">});</div></div><!-- fragment --><p>Run tasks: </p><div class="fragment"><div class="line">// named serial</div><div class="line">gtx.alias(&#39;many&#39;, [&#39;one&#39;, &#39;two&#39;, &#39;three&#39;]);</div><div class="line"></div><div class="line">// named concurrent (max cpu cores)</div><div class="line">gtx.concurrent(&#39;many&#39;, [&#39;one&#39;, &#39;two&#39;, &#39;three&#39;]);</div></div><!-- fragment --><p>Generate a unique name for a configuration (this is the basis for the macro feature) </p><div class="fragment"><div class="line">var name = gtx.configFor(&#39;myPlugin&#39;, {</div><div class="line">    src: [&#39;./files/gamma/*.js&#39;]</div><div class="line">});</div><div class="line"></div><div class="line">// do creative stuff by generating tasks (go wild here)</div><div class="line">gtx.alias(&#39;bulk_run&#39;, [&#39;one&#39;, &#39;two&#39;, &#39;three&#39;].map(function (name) {</div><div class="line">    return gtx.configFor(&#39;myPlugin&#39;, {</div><div class="line">        src: [&#39;./files/&#39; + name + &#39;.js&#39;]</div><div class="line">    });</div><div class="line">}));</div><div class="line"></div><div class="line">// generated tasks from parallel() to run concurrently</div><div class="line">gtx.alias(&#39;many&#39;, [&#39;one&#39;, gtx.parallel(&#39;two&#39;, &#39;three&#39;)]);</div><div class="line"></div><div class="line">// generated tasks from serial()</div><div class="line">gtx.alias(&#39;more&#39;, [&#39;one&#39;, </div><div class="line">    gtx.parallel(</div><div class="line">        gtx.serial(&#39;two&#39;, &#39;three&#39;),</div><div class="line">        gtx.serial(&#39;four&#39;, &#39;five&#39;))</div><div class="line">    )</div><div class="line">]);</div></div><!-- fragment --><p>This example is lifted from the <a href="https://github.com/DefinitelyTyped/tsd/blob/develop-0.5.x/Gruntfile.js">gruntfile of TSD</a> and shows a macro to compile and run separated 'test modules'. These can also be run concurrently to cut-down on overall test-duration for IO heavy topics.</p>
<p>Note how the macro uses a few plugins to setup and run: it would be a hassle to maintain these modules in a regular gruntfile but it is easy when using a macro to build the instance:</p>
<div class="fragment"><div class="line">gtx.define(&#39;module_tester&#39;, function (macro, id) {</div><div class="line">    // the macro object is a context with helpers to assemble a new instance named &#39;id&#39;</div><div class="line"></div><div class="line">    // let&#39;s use the instance id to build a shared path</div><div class="line">    var testPath = &#39;test/modules/&#39; + id + &#39;/&#39;;</div><div class="line"></div><div class="line">    // use grunt-contrib-clean to remove old test output</div><div class="line">    macro.add(&#39;clean&#39;, [testPath + &#39;tmp/**/*&#39;]);</div><div class="line"></div><div class="line">    // run a regular task</div><div class="line">    macro.run(&#39;myPlugin:dev&#39;);</div><div class="line"></div><div class="line">    // use grunt-ts to compile the TypeScript test cases</div><div class="line">    macro.add(&#39;ts&#39;, {</div><div class="line">        options: {},</div><div class="line">        src: [testPath + &#39;src/**/*.ts&#39;],</div><div class="line">        out: testPath + &#39;tmp/&#39; + id + &#39;.test.js&#39;</div><div class="line">    });</div><div class="line">    // use grunt-tslint</div><div class="line">    macro.add(&#39;tslint&#39;, {</div><div class="line">        src: [testPath + &#39;src/**/*.ts&#39;]</div><div class="line">    });</div><div class="line">    // optionally spawn a grunt-contrib-connect</div><div class="line">    if (macro.getParam(&#39;http&#39;, 0) &gt; 0) {</div><div class="line">        macro.add(&#39;connect&#39;, {</div><div class="line">            options: {</div><div class="line">                port: macro.getParam(&#39;http&#39;),</div><div class="line">                base: testPath + &#39;www/&#39;</div><div class="line">            }</div><div class="line">        });</div><div class="line">        //tag for easy retrieval</div><div class="line">        macro.tag(&#39;http&#39;);</div><div class="line">    }</div><div class="line">    // run grunt-mocha-test on the compiled test cases</div><div class="line">    macro.add(&#39;mochaTest&#39;, {</div><div class="line">        options: {</div><div class="line">            timeout: macro.getParam(&#39;timeout&#39;, 2000)</div><div class="line">        },</div><div class="line">        src: [testPath + &#39;tmp/**/*.test.js&#39;]</div><div class="line">    });</div><div class="line">}, {</div><div class="line">    // optionally run parallel using grunt-concurrent (for now only from gtx-type)</div><div class="line">    concurrent: 4</div><div class="line">});</div></div><!-- fragment --><p>Use the macro to make many similar instances: </p><div class="fragment"><div class="line">// use the macro to make many instances</div><div class="line">gtx.create(&#39;git&#39;, &#39;module_tester&#39;, null, &#39;lib&#39;);</div><div class="line">gtx.create(&#39;tsd&#39;, &#39;module_tester&#39;, {timeout: 10000}, &#39;lib,core&#39;);</div><div class="line">gtx.create(&#39;http&#39;, &#39;module_tester&#39;, {</div><div class="line">    timeout: 20000,</div><div class="line">    http: 8080</div><div class="line">}, &#39;lib&#39;);</div><div class="line">// bulk</div><div class="line">gtx.create(&#39;basic,remote,local&#39;, &#39;module_tester&#39;);</div><div class="line">gtx.create([&#39;basic&#39;,&#39;remote&#39;,&#39;local&#39;], &#39;module_tester&#39;);</div></div><!-- fragment --><p>Mix functions and id's: </p><div class="fragment"><div class="line">// mix calls in alias</div><div class="line">gtx.alias(&#39;mix&#39;, [&#39;alpha:one&#39;, &#39;bravo:two&#39;, function() {</div><div class="line">    grunt.log.writeln(&#39;roger&#39;);</div><div class="line">}, &#39;charlie&#39;, function() {</div><div class="line">    grunt.log.writeln(&#39;roger&#39;);</div><div class="line">}]);</div></div><!-- fragment --><p>Finish up: </p><div class="fragment"><div class="line">    // let&#39;s make an alias to run all instances as your $ grunt test</div><div class="line">    gtx.alias(&#39;test&#39;, &#39;gtx-type:module_tester&#39;);</div><div class="line"></div><div class="line">    // alias is short-cut for grunt.registerTask();</div><div class="line">    gtx.alias(&#39;default&#39;, [&#39;test&#39;]);</div><div class="line"></div><div class="line">    // compile and send to grunt.initConfig()</div><div class="line">    gtx.finalise();</div><div class="line">};</div></div><!-- fragment --><p>To run these macro instances: </p><div class="fragment"><div class="line">$ grunt -h</div><div class="line">$ grunt gtx:git</div><div class="line">$ grunt gtx-group:core</div><div class="line">$ grunt gtx-group:http</div><div class="line">$ grunt gtx-type:module_tester</div><div class="line"></div><div class="line">// bonus: clean all</div><div class="line">$ grunt clean</div></div><!-- fragment --><h3>Additional examples:</h3>
<ul>
<li>Complex example from <a href="https://github.com/Bartvds/mocha-unfunk-reporter/blob/abc2732c1c44aca17dc8a7c647aa1f3d7313279e/Gruntfile.js">mocha-unfunk-reporter</a> uses a macro to setup a CLI output bulk tester (this is also a warning about power and responsibility).</li>
</ul>
<h2>Info</h2>
<ul>
<li>Your gruntfile is still a regular gruntfile to run by <code>grunt-cli</code>.<ul>
<li>Use the <code>grunt -h</code> command to view the generated tasks.</li>
<li>Main difference is to import and apply <code>gruntfile-gtx</code> on start if the Gruntfile.</li>
<li>Call <code>gtx.finalise()</code> at the end of the file to generate the config and apply aliases.</li>
</ul>
</li>
<li>Generated aliases are prefixed with <code>gtx</code>, like <code>gtx-select:myAlias</code> or <code>gtx-group:dev</code>.<ul>
<li>They run like any task created by <code>grunt.registerTask()</code>.</li>
</ul>
</li>
<li>The extra API sugar like <code>gtx.loadNpm()</code> is optional, but is generally DRY-er then the regular versions.</li>
<li>String input uses a form of expansion and iteration where applicable.<ul>
<li>Split strings on separators to array: `gtx.alias('name', 'one, two, three')<code></code></li>
<li><code> Nested arrays are flattened and the content split:</code>gtx.alias('name', [['aa','bb'], 'cc', ['dd, ee'],'ff,gg,hh'])<code></code></li>
<li><code> Where grunt methods accept a single string the alias will iterate:</code>gtx.loadNpm([..])`</li>
</ul>
</li>
<li>Gruntfile-gtx was grown organically: no gold-plating but some edges made shiny from wear.</li>
</ul>
<h2>Future</h2>
<p>There a lot of ideas for this floating around for this, from auto-dependency chains and non-repeating macro util tasks, to globbing helpers to generate macro instances and flows adapting to custom cli parameters or env variables. Also it would be cool to interface with (Yeoman) generators for easy instancing of build sub modules.</p>
<p>Most of these wait until Grunt reaches <code>0.5.0</code> which solve some of the original problems.</p>
<h2>API</h2>
<p>See above usage examples and look at the <a href="https://github.com/Bartvds/gruntfile-gtx/blob/master/Gruntfile.js">Gruntfile</a> and <a href="https://github.com/Bartvds/gruntfile-gtx/tree/master/test/spec">the tests</a> for more usage.</p>
<h1>History</h1>
<ul>
<li>0.3.0 - Updated dependencies (thanks )</li>
<li>0.2.5 - Fixed <code>gtx.call()</code> and <code>macro.call()</code>.</li>
<li>0.2.3 - Fixed <code>gtx.multi()</code>, added <code>gtx.concurrent()</code>, <code>gtx.serial()</code>, <code>gtx.parallel()</code></li>
<li>0.2.2 - Output fix.</li>
<li>0.2.1 - Added <code>macro.call()</code>, <code>gtx.call()</code>, <code>gtx.multi()</code>, added function support to <code>gtx.alias()</code>.</li>
<li>0.1.1 - Fixed some bugs</li>
<li>0.1.0 - Renamed some methods on <code>gtx</code> api, added <code>gtx.readJSON()</code>/<code>gtx.readYAML()</code> helpers</li>
<li>0.0.8 - Cleaned task, small fixes, bundle <a href="https://github.com/sindresorhus/load-grunt-tasks">load-grunt-tasks</a> (via <code>grunt.loadAuto()</code>)</li>
<li>0.0.5 - Added concurrent-execution to <code>gtx:type</code></li>
<li>0.0.3 - NPM push</li>
<li>0.0.2 - Various construction work</li>
</ul>
<h2>Contributing</h2>
<p>Contributions are welcome (idiomatic, clean etc) but best to post a proposal in the <a href="https://github.com/Bartvds/gruntfile-gtx/issues">Issues</a> before making big changes.</p>
<h2>Vagrant</h2>
<p>There is a Vagrantfile and set of Chef cookbooks to use with <a href="http://www.vagrantup.com">Vagrant</a> for easy testing on a Linux VM. It will install a node.js from package, install the dependencies and enable grunt.</p>
<h2>License</h2>
<p>Copyright (c) 2013 Bart van der Schoor</p>
<p>Licensed under the MIT license.</p>
<p><a href="https://bitdeli.com/free" title="Bitdeli Badge"></a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
