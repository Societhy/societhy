<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: ws: a node.js websocket library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ws: a node.js websocket library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/websockets/ws"></a></p>
<p><code>ws</code> is a simple to use WebSocket implementation, up-to-date against RFC-6455, and <a href="http://web.archive.org/web/20130314230536/http://hobbycoding.posterous.com/the-fastest-websocket-module-for-nodejs">probably the fastest WebSocket library for node.js</a>.</p>
<p>Passes the quite extensive Autobahn test suite. See <a href="http://websockets.github.com/ws">http://websockets.github.com/ws</a> for the full reports.</p>
<h2>Protocol support</h2>
<ul>
<li><b>Hixie draft 76</b> (Old and deprecated, but still in use by Safari and Opera. Added to ws version 0.4.2, but server only. Can be disabled by setting the <code>disableHixie</code> option to true.)</li>
<li><b>HyBi drafts 07-12</b> (Use the option <code>protocolVersion: 8</code>)</li>
<li><b>HyBi drafts 13-17</b> (Current default, alternatively option <code>protocolVersion: 13</code>)</li>
</ul>
<h3>Installing</h3>
<div class="fragment"><div class="line">npm install --save ws</div></div><!-- fragment --><h3>Opt-in for performance</h3>
<p>There are 2 optional modules that can be installed along side with the <code>ws</code> module. These modules are binary addons which improve certain operations, but as they are binary addons they require compilation which can fail if no c++ compiler is installed on the host system.</p>
<ul>
<li><code>npm install --save bufferutil</code>: Improves internal buffer operations which allows for faster processing of masked WebSocket frames and general buffer operations.</li>
<li><code>npm install --save utf-8-validate</code>: The specification requires validation of invalid UTF-8 chars, some of these validations could not be done in JavaScript hence the need for a binary addon. In most cases you will already be validating the input that you receive for security purposes leading to double validation. But if you want to be 100% spec-conforming and have fast validation of UTF-8 then this module is a must.</li>
</ul>
<h3>Sending and receiving text data</h3>
<div class="fragment"><div class="line">var WebSocket = require(&#39;ws&#39;);</div><div class="line">var ws = new WebSocket(&#39;ws://www.host.com/path&#39;);</div><div class="line"></div><div class="line">ws.on(&#39;open&#39;, function open() {</div><div class="line">  ws.send(&#39;something&#39;);</div><div class="line">});</div><div class="line"></div><div class="line">ws.on(&#39;message&#39;, function(data, flags) {</div><div class="line">  // flags.binary will be set if a binary data is received.</div><div class="line">  // flags.masked will be set if the data was masked.</div><div class="line">});</div></div><!-- fragment --><h3>Sending binary data</h3>
<div class="fragment"><div class="line">var WebSocket = require(&#39;ws&#39;);</div><div class="line">var ws = new WebSocket(&#39;ws://www.host.com/path&#39;);</div><div class="line"></div><div class="line">ws.on(&#39;open&#39;, function open() {</div><div class="line">  var array = new Float32Array(5);</div><div class="line"></div><div class="line">  for (var i = 0; i &lt; array.length; ++i) {</div><div class="line">    array[i] = i / 2;</div><div class="line">  }</div><div class="line"></div><div class="line">  ws.send(array, { binary: true, mask: true });</div><div class="line">});</div></div><!-- fragment --><p>Setting <code>mask</code>, as done for the send options above, will cause the data to be masked according to the WebSocket protocol. The same option applies for text data.</p>
<h3>Server example</h3>
<div class="fragment"><div class="line">var WebSocketServer = require(&#39;ws&#39;).Server</div><div class="line">  , wss = new WebSocketServer({ port: 8080 });</div><div class="line"></div><div class="line">wss.on(&#39;connection&#39;, function connection(ws) {</div><div class="line">  ws.on(&#39;message&#39;, function incoming(message) {</div><div class="line">    console.log(&#39;received: %s&#39;, message);</div><div class="line">  });</div><div class="line"></div><div class="line">  ws.send(&#39;something&#39;);</div><div class="line">});</div></div><!-- fragment --><h3>ExpressJS example</h3>
<div class="fragment"><div class="line">var server = require(&#39;http&#39;).createServer()</div><div class="line">  , url = require(&#39;url&#39;)</div><div class="line">  , WebSocketServer = require(&#39;ws&#39;).Server</div><div class="line">  , wss = new WebSocketServer({ server: server })</div><div class="line">  , express = require(&#39;express&#39;)</div><div class="line">  , app = express()</div><div class="line">  , port = 4080;</div><div class="line"></div><div class="line">app.use(function (req, res) {</div><div class="line">  res.send({ msg: &quot;hello&quot; });</div><div class="line">});</div><div class="line"></div><div class="line">wss.on(&#39;connection&#39;, function connection(ws) {</div><div class="line">  var location = url.parse(ws.upgradeReq.url, true);</div><div class="line">  // you might use location.query.access_token to authenticate or share sessions</div><div class="line">  // or ws.upgradeReq.headers.cookie (see http://stackoverflow.com/a/16395220/151312)</div><div class="line"></div><div class="line">  ws.on(&#39;message&#39;, function incoming(message) {</div><div class="line">    console.log(&#39;received: %s&#39;, message);</div><div class="line">  });</div><div class="line"></div><div class="line">  ws.send(&#39;something&#39;);</div><div class="line">});</div><div class="line"></div><div class="line">server.on(&#39;request&#39;, app);</div><div class="line">server.listen(port, function () { console.log(&#39;Listening on &#39; + server.address().port) });</div></div><!-- fragment --><h3>Server sending broadcast data</h3>
<div class="fragment"><div class="line">var WebSocketServer = require(&#39;ws&#39;).Server</div><div class="line">  , wss = new WebSocketServer({ port: 8080 });</div><div class="line"></div><div class="line">wss.broadcast = function broadcast(data) {</div><div class="line">  wss.clients.forEach(function each(client) {</div><div class="line">    client.send(data);</div><div class="line">  });</div><div class="line">};</div></div><!-- fragment --><h3>Error handling best practices</h3>
<div class="fragment"><div class="line">// If the WebSocket is closed before the following send is attempted</div><div class="line">ws.send(&#39;something&#39;);</div><div class="line"></div><div class="line">// Errors (both immediate and async write errors) can be detected in an optional</div><div class="line">// callback. The callback is also the only way of being notified that data has</div><div class="line">// actually been sent.</div><div class="line">ws.send(&#39;something&#39;, function ack(error) {</div><div class="line">  // if error is not defined, the send has been completed,</div><div class="line">  // otherwise the error object will indicate what failed.</div><div class="line">});</div><div class="line"></div><div class="line">// Immediate errors can also be handled with try/catch-blocks, but **note** that</div><div class="line">// since sends are inherently asynchronous, socket write failures will *not* be</div><div class="line">// captured when this technique is used.</div><div class="line">try { ws.send(&#39;something&#39;); }</div><div class="line">catch (e) { /* handle error */ }</div></div><!-- fragment --><h3>echo.websocket.org demo</h3>
<div class="fragment"><div class="line">var WebSocket = require(&#39;ws&#39;);</div><div class="line">var ws = new WebSocket(&#39;ws://echo.websocket.org/&#39;, {</div><div class="line">  protocolVersion: 8,</div><div class="line">  origin: &#39;http://websocket.org&#39;</div><div class="line">});</div><div class="line"></div><div class="line">ws.on(&#39;open&#39;, function open() {</div><div class="line">  console.log(&#39;connected&#39;);</div><div class="line">  ws.send(Date.now().toString(), {mask: true});</div><div class="line">});</div><div class="line"></div><div class="line">ws.on(&#39;close&#39;, function close() {</div><div class="line">  console.log(&#39;disconnected&#39;);</div><div class="line">});</div><div class="line"></div><div class="line">ws.on(&#39;message&#39;, function message(data, flags) {</div><div class="line">  console.log(&#39;Roundtrip time: &#39; + (Date.now() - parseInt(data)) + &#39;ms&#39;, flags);</div><div class="line"></div><div class="line">  setTimeout(function timeout() {</div><div class="line">    ws.send(Date.now().toString(), {mask: true});</div><div class="line">  }, 500);</div><div class="line">});</div></div><!-- fragment --><h3>Other examples</h3>
<p>For a full example with a browser client communicating with a ws server, see the examples folder.</p>
<p>Note that the usage together with Express 3.0 is quite different from Express 2.x. The difference is expressed in the two different serverstats-examples.</p>
<p>Otherwise, see the test cases.</p>
<h3>Running the tests</h3>
<div class="fragment"><div class="line">make test</div></div><!-- fragment --><h2>API Docs</h2>
<p>See https://github.com/websockets/ws/blob/master/doc/ws.md "`/doc/ws.md`" for Node.js-like docs for the ws classes.</p>
<h2>Changelog</h2>
<p>We're using the GitHub <a href="https://github.com/websockets/ws/releases"><code>releases</code></a> for changelog entries.</p>
<h2>License</h2>
<p>(The MIT License)</p>
<p>Copyright (c) 2011 Einar Otto Stangvik &lt;<a href="#" onclick="location.href='mai'+'lto:'+'ein'+'ar'+'os@'+'gm'+'ail'+'.c'+'om'; return false;">einar<span style="display: none;">.nosp@m.</span>os@g<span style="display: none;">.nosp@m.</span>mail.<span style="display: none;">.nosp@m.</span>com</a>&gt;</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the 'Software'), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
